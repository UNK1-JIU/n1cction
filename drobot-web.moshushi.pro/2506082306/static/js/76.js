webpackJsonp([76],{"/vAe":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo4ODUyQzFCMUNCNDUxMUU0ODNDNEM4QkFFQUYzRUQ0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo4ODUyQzFCMkNCNDUxMUU0ODNDNEM4QkFFQUYzRUQ0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjg4NTJDMUFGQ0I0NTExRTQ4M0M0QzhCQUVBRjNFRDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjg4NTJDMUIwQ0I0NTExRTQ4M0M0QzhCQUVBRjNFRDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+6CTf0wAAAO9JREFUeNpi/P//PwMWYALEjkAMktwHxOfQFTCiaWQC4plA7A7E64D4HxCHAPE2IM6C8iEApBEJlwLxISDmRhIDsQ8DcRGyWnSNd4HYEE0MhI2A+DayGLpT/wAxB5RGBqxA/B2IWXA59Q4OG42B+BY+pxZB/YPsR14gPgrEufg0MgHxDCB+BMQToPgxEP8A4n4g5kLXKAI1VQHKBzm3GIp1gVgUiBcD8XkgFoZpBAXQXiBuw+I3dNwDxLthGoOA+BTUmYQ0MkNtDQBxtgBxGBGaYDgGiDeBGG+gfiRWoxQQvwL57yMwOvkYSAMfAAIMAHO91ldFex1LAAAAAElFTkSuQmCC"},fTbW:function(e,t,i){(e.exports=i("FZ+f")(!1)).push([e.i,"",""])},wQTO:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i("Xxa5"),a=i.n(o),n=i("exGp"),s=i.n(n),r=i("0xDb"),l=i("E4LH"),d=i("lYQe"),c={data:function(){return{mobileCodeTimer:null,show:!0,count:"",isMoshuShiWebSite:!0,titleText:"",backgroundType:1,dialogVisible:!1,confirmDialogVisible:!1,companyList:[],loginImg:"",loginId:"",loginOpenId:null,dataForm:{userName:"",password:"",companyId:"",uuid:"",captcha:"",checked:["true"]},dataFormMobileCode:{checked:["true"],mobile:"",mobileCode:""},agreePolicy:!0,dataRule:{checked:[{type:"array",required:!0,message:"请阅读确认已阅读《播不停用户协议》",trigger:"change"}],userName:[{required:!0,message:" ",trigger:"blur"}],password:[{required:!0,message:" ",trigger:"blur"}],captcha:[{required:!0,message:" ",trigger:"blur"}]},dataRuleMobileCode:{checked:[{type:"array",required:!0,message:"请阅读确认已阅读《播不停用户协议》",trigger:"change"}],mobile:[{required:!0,message:" ",trigger:"blur"}],mobileCode:[{required:!0,message:" ",trigger:"blur"}]},captchaPath:"",loginType:"2",timer:null}},activated:function(){},created:function(){this.$isMobile?i.e(122).then(i.bind(null,"Dg7G")):i.e(121).then(i.bind(null,"E9JX")),this.randomBackGround()},mounted:function(){2==this.backgroundType&&this.hackBackground(),this.checkIsMoshushiWebSite(),null!=this.$route.params.autoLoginWxOpenId&&(this.loginOpenId=this.$route.params.autoLoginWxOpenId,this.loginByWxOpenId())},beforeRouteLeave:function(e,t,i){clearTimeout(this.timer),i()},methods:{getCode:function(){var e=this;if(Object(l.c)(this.dataFormMobileCode.mobile)){var t={phoneNum:this.dataFormMobileCode.mobile};this.$http({url:this.$http.adornUrl("/sms/sendsms?phoneNum="+this.dataFormMobileCode.mobile),header:{"content-type":"application/x-www-form-urlencoded"},data:t,method:"post"}).then(function(t){var i=t.data;i&&0===i.code?(console.log("倒计时开始"),e.mobileCodeTimer||(e.count=60,e.show=!1,e.mobileCodeTimer=setInterval(function(){e.count>0&&e.count<=60?e.count--:(e.show=!0,clearInterval(e.mobileCodeTimer),e.mobileCodeTimer=null)},1e3))):e.$message.error(i.msg)})}else this.$message.info("请输入正确的手机号！")},checkIsMoshushiWebSite:function(){window.location.href},randomBackGround:function(){this.backgroundType=1},hackBackground:function(){var e=document.querySelector("canvas"),t=e.getContext("2d"),i=window.screen,o=e.width=i.width,a=e.height=i.height;t.fillStyle=s();var n=Array(256).join("1").split("");function s(){for(var e=Math.ceil(16777215*Math.random()).toString(16);e.length<6;)e="0"+e;return"#"+e}setInterval(function(){t.fillStyle="rgba(0,0,0,0.05)",t.fillRect(0,0,o,a),t.fillStyle=s(),n.map(function(e,i){var o=String.fromCharCode(Math.ceil(65+57*Math.random())),a=10*i;t.fillText(o,a,e),n[i]=e>758+484*Math.random()?0:e+10})},50)},loginWithCompanyId:function(e){this.dataForm.companyId=e,"1"==this.loginType?this.loginByWxOpenId():"2"==this.loginType?this.dataFormSubmit():"3"==this.loginType&&this.loginByMobileCode()},createLoginImg:function(){var e=this;this.$http({url:this.$http.adornUrlWx("manage/wxQrCode/createLoginTicket"),method:"post",data:this.$http.adornData({})}).then(function(t){var i=t.data;i&&(e.loginImg=i.url,e.loginId=i.loginId,e.checkOpenId())})},checkOpenId:function(){var e=this;this.$http({url:this.$http.adornUrlWx("/manage/wxMsg/loginScan/"+this.loginId),method:"get"}).then(function(t){var i=t.data;i&&i.data?(clearTimeout(e.timer),e.loginOpenId=i.data,e.loginByWxOpenId()):e.timer=setTimeout(function(){e.checkOpenId()},1e3)})},processLoginErrorInfo:function(e){var t=this;20006==e.code?this.$alert("您的账号没有关联的组织，或者被组织注销，去创建或加入一个组织？","提示",{showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",callback:function(i){"confirm"==i&&t.$router.replace({name:"createCompany",params:{userInfoId:e.userInfoId}})}}):20007==e.code?this.$alert("加入此组织的申请被管理员拒绝，此消息将不再通知，去创建或加入一个组织？","提示",{showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",callback:function(i){"confirm"==i&&t.$router.replace({name:"createCompany",params:{userInfoId:e.userInfoId}})}}):this.$message.error(e.msg)},loginByWxOpenId:function(){var e=this;if(!this.agreePolicy)return this.$message.error("请同意并勾选协议"),void this.createLoginImg();this.$http({url:this.$http.adornUrl("/sys/loginByOpenId"),method:"post",data:this.$http.adornParams({wxOpenId:this.loginOpenId,companyId:this.dataForm.companyId})}).then(function(t){var i=t.data;i&&0===i.code?i.newUser?e.$router.replace({name:"register",params:{wxOpenId:e.loginOpenId,registeNew:!0}}):i.needSelectCompany?(e.loginType=1,e.dialogVisible=!0,e.companyList=i.companys):Object(d.a)(i,e):(e.processLoginErrorInfo(i),e.createLoginImg())})},handleSelect:function(e,t){console.log(e,t),this.loginType=e},text:function(e){console.log(e)},loginByMobileCode:function(){var e=this;this.agreePolicy?this.$refs.dataFormMobileCodeView.validate(function(t){t&&e.$http({url:e.$http.adornUrl("/sys/loginByMobileCode"),method:"post",data:e.$http.adornData({mobile:e.dataFormMobileCode.mobile,mobileCode:e.dataFormMobileCode.mobileCode,companyId:e.dataForm.companyId})}).then(function(t){var i=t.data;i&&0===i.code?i.newUser?e.$message.error("账号或密码错误！"):i.needSelectCompany?(e.loginType=3,e.dialogVisible=!0,e.companyList=i.companys):Object(d.a)(i,e):e.processLoginErrorInfo(i)})}):this.$message.error("请同意并勾选协议")},dataFormSubmit:function(){var e=this;this.agreePolicy?this.$refs.dataForm.validate(function(t){t&&e.$http({url:e.$http.adornUrl("/sys/login_mobile"),method:"post",data:e.$http.adornData({username:e.dataForm.userName,password:e.dataForm.password})}).then(function(t){var i=t.data;i&&0===i.code?i.needSelectCompany?(e.loginType=2,e.dialogVisible=!0,e.companyList=i.companys):Object(d.a)(i,e):(e.getCaptcha(),e.processLoginErrorInfo(i))})}):this.$message.error("请同意并勾选协议")},register:function(){this.$router.push({name:"register",params:{registeNew:!0}})},Forgetpwd:function(){var e=this;return s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.$router.push({name:"ForgotPwd"});case 1:case"end":return t.stop()}},t,e)}))()},getCaptcha:function(){this.dataForm.uuid=Object(r.r)(),this.captchaPath=this.$http.adornUrl("/captcha.jpg?uuid="+this.dataForm.uuid)}}},u={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"site-wrapper site-page--login"},[2==e.backgroundType?o("canvas",{ref:"canvas"},[e._v(" 您的浏览器不支持canvas标签，请您更换浏览器")]):e._e(),e._v(" "),o("div",{staticClass:"site-content__wrapper"},[e.isMoshuShiWebSite?o("div",{staticClass:"brand-info"},[o("p",{staticClass:"brand-info__intro"},[e._v("登录")])]):o("div",{staticClass:"brand-info"},[o("p",{staticClass:"brand-info__text"},[e._v(e._s(e.titleText))])]),e._v(" "),o("div",[o("div",{staticClass:"site-content login"},[o("div",{staticClass:"row"},[o("div",[o("div",{staticClass:"pcenter"},["2"==e.loginType?o("div",[o("el-form",{ref:"dataForm",staticClass:"login_fields",attrs:{model:e.dataForm,rules:e.dataRule,"status-icon":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmit()}}},[o("div",{staticClass:"login_fields__user"},[o("el-form-item",{attrs:{prop:"userName"}},[o("el-input",{attrs:{placeholder:"账号",size:"medium"},model:{value:e.dataForm.userName,callback:function(t){e.$set(e.dataForm,"userName",t)},expression:"dataForm.userName"}})],1)],1),e._v(" "),o("div",{staticClass:"login_fields__password"},[o("el-form-item",{attrs:{prop:"password"}},[o("el-input",{attrs:{type:"password",size:"medium",placeholder:"密码"},model:{value:e.dataForm.password,callback:function(t){e.$set(e.dataForm,"password",t)},expression:"dataForm.password"}})],1)],1),e._v(" "),o("div",{staticClass:"login_fields__password"}),e._v(" "),o("div",{staticClass:"login_fields__submit"},[o("el-form-item",[o("el-button",{staticClass:"login-btn-submit",attrs:{type:"mini"},on:{click:function(t){return e.dataFormSubmit()}}},[e._v("登录\n                      ")]),e._v(" "),o("div",{staticClass:"row regist"},[e.isMoshuShiWebSite?o("a",{staticClass:"shengqingzhuce",on:{click:function(t){e.confirmDialogVisible=!0}}},[e._v("申请注册")]):e._e(),e._v(" "),o("a",{staticClass:"shengqingzhuce",on:{click:function(t){return e.Forgetpwd()}}},[e._v("忘记密码")])])],1)],1)])],1):"3"==e.loginType?o("div",[o("el-form",{ref:"dataFormMobileCodeView",staticClass:"login_fields",attrs:{model:e.dataFormMobileCode,rules:e.dataRuleMobileCode,"status-icon":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loginByMobileCode()}}},[o("div",{staticClass:"login_fields__user"},[o("div",{staticClass:"icon"},[o("img",{attrs:{src:i("/vAe"),alt:""}})]),e._v(" "),o("el-form-item",{attrs:{prop:"mobile"}},[o("el-input",{attrs:{placeholder:"手机号",size:"medium"},model:{value:e.dataFormMobileCode.mobile,callback:function(t){e.$set(e.dataFormMobileCode,"mobile",t)},expression:"dataFormMobileCode.mobile"}})],1)],1),e._v(" "),o("div",{staticClass:"login_fields__password"},[o("el-form-item",{attrs:{prop:"mobileCode"}},[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:15}},[o("el-input",{attrs:{size:"medium",placeholder:"验证码"},model:{value:e.dataFormMobileCode.mobileCode,callback:function(t){e.$set(e.dataFormMobileCode,"mobileCode",t)},expression:"dataFormMobileCode.mobileCode"}})],1),e._v(" "),o("el-button",{staticClass:"code-btn",attrs:{size:"medium"},on:{click:function(t){return t.preventDefault(),e.getCode(t)}}},[o("span",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}]},[e._v("获取验证码")]),e._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:!e.show,expression:"!show"}],staticClass:"count"},[e._v(e._s(e.count)+" s")])])],1)],1)],1),e._v(" "),o("div",{staticClass:"login_fields__submit"},[o("el-form-item",[o("el-button",{staticClass:"login-btn-submit",attrs:{type:"mini"},on:{click:function(t){return e.loginByMobileCode()}}},[e._v("登录\n                      ")]),e._v(" "),o("br")],1)],1)])],1):e._e()])])]),e._v(" "),e.isMoshuShiWebSite?o("div",{staticStyle:{"font-size":"10px","margin-top":"60px"}},[o("el-checkbox",{attrs:{checked:!0,"text-color":"#ffffff",size:"mini",label:""},model:{value:e.agreePolicy,callback:function(t){e.agreePolicy=t},expression:"agreePolicy"}}),e._v(" "),o("span",{staticClass:"policytext"},[e._v("此软件仅供学习交流，不能作为其他商业用途，注册即同意")]),e._v(" "),o("router-link",{staticClass:"policytext",attrs:{to:"policy",tag:"a",target:"_blank"}},[e._v("《软件使用协议》\n          ")])],1):e._e()])])]),e._v(" "),o("el-dialog",{attrs:{title:"选择公司组织登录",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},e._l(e.companyList,function(t){return o("div",[o("el-button",{staticClass:"companyList",on:{click:function(i){return e.loginWithCompanyId(t.tenantId)}}},[e._v(e._s(t.name))])],1)}),0),e._v(" "),o("el-dialog",{attrs:{title:"提示",visible:e.confirmDialogVisible,width:e.$isMobile?"90%":"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.confirmDialogVisible=t}}},[o("span",[e._v("同一用户所有设备只需注册一个账号，建议使用统一的一个账号来管理。确定要再注册个新账号吗？")]),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.confirmDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.register()}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var m=i("VU/8")(c,u,!1,function(e){i("yOGG")},"data-v-bd481a4a",null);t.default=m.exports},yOGG:function(e,t,i){var o=i("fTbW");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);i("rjj0")("ae242dfa",o,!0)}});